<% 
  filtered = params[:cited] || params[:query]
  prefix = params[:cited] ? "Cited " : "All "
  suffix = params[:query] ? " with DOIs containing '#{params[:query]}'" : ""
-%>
<h2><%= prefix %>Articles<%= suffix %></h2>
<div>
<%= link_to('Show all articles', articles_path) if filtered %>
<%= link_to('Show only cited articles', articles_path(:cited => 1, :query => params[:query])) unless params[:cited] %>
<%= link_to 'Add another article', new_article_path %>
</div>

<% if @articles.first %>
  <% for article in @articles %>
  <div class="article">
    <span class="doi"><%= link_to article.doi, article %></span>
    <span class="details">
      <%= pluralize article.citations_count, "citation" %> from
      <%= pluralize article.cited_retrievals_count, "source" %>, 
      <%= (article.retrieved_at.year < 2000) ? 
          "never updated" : "updated #{article.retrieved_at.to_s(:friendly)}" %>
    </span>
  </div>
  <% end %>
<% else %>
  <div>No <%= "cited " if params[:cited] %>articles found</div>
<% end %>
<%= will_paginate @articles %>


